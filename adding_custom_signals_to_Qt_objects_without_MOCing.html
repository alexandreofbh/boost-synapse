<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Strict//EN'
'http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
<head>
	<meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
	<title>adding custom signals to Qt objects without MOCing</title>
	<link href='reno.css' type='text/css' rel='stylesheet'/>
</head>
<body>
<div class="body-0">
<div class="body-1">
<div class="body-2">
<div>
<div id="reverge_logo">
<a href="http://www.revergestudios.com"><img style="border:0" src="reverge.png" alt="Reverge"/></a>
</div>
<h1><a href="index.html">Boost Synapse</a></h1>
</div>
<!-- Copyright (c) 2015 Emil Dotchevski and Reverge Studios, Inc. -->
<!-- Distributed under the Boost Software License, Version 1.0. (See accompanying -->
<!-- file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt) -->
<div class="RenoIncludeDIV"><div class="RenoAutoDIV"><h3>Adding Custom Signals to Qt Objects Without MOCing</h3>
</div>
<p>The Qt Wiki contains the following example on creating custom signals and slots:</p>
<blockquote><p><span class="RenoLink"><a href="https://wiki.qt.io/Qt_for_Beginners#Creating_custom_signals_and_slots">https://wiki.qt.io/Qt_for_Beginners#Creating_custom_signals_and_slots</a></span></p></blockquote>
<p>It requires running the Qt Meta Object Compiler.</p>
<p>Below is the same example, modified to use <i><span class="RenoLink"><a href="index.html">Boost Synapse</a></span></i> to implement the custom <i>counterReached</i> signal. This approach does not require running the Qt Meta Object Compiler.</p>
<p>The changes made to the original program are marked with //&lt;--.</p>
<pre>#include &lt;<span class="RenoLink"><a href="boost_synapse_connect_hpp.html">boost/synapse/connect.hpp</a></span>&gt;
#include &lt;boost/bind.hpp&gt;
#define QT_NO_EMIT //Suppress the #define emit from Qt since it clashes with boost::synapse::emit.
#include &lt;QtWidgets/QApplication&gt;
#include &lt;QtWidgets/QPushButton&gt;

namespace synapse = boost::synapse;

class Window : public QWidget
{
public:
 explicit Window(QWidget *parent = 0);
signals: //&lt;-- Not needed with Synapse but okay
 typedef struct counterReached_(*counterReached)(); //&lt;-- Was: void counterReached();
private slots: //&lt;-- Not needed with Synapse but okay
 void slotButtonClicked(bool checked);
private:
 int m_counter;
 QPushButton *m_button;
 boost::shared_ptr&lt;synapse::<span class="RenoLink"><a href="connection.html">connection</a></span>&gt; c_; //&lt;-- Needed to keep the synapse connection afloat.
};

Window::Window(QWidget *parent) :
 QWidget(parent)
{
 // Set size of the window
 setFixedSize(100, 50);
 
 // Create and position the button
 m_button = new QPushButton("Hello World", this);
 m_button-&gt;setGeometry(10, 10, 80, 30);
 m_button-&gt;setCheckable(true);
 
 // Set the counter to 0
 m_counter = 0;
 
 connect(m_button,&amp;QPushButton::clicked,boost::bind(&amp;Window::slotButtonClicked,this,_1)); //&lt;-- Was: connect(m_button, SIGNAL (clicked(bool)), this, SLOT (slotButtonClicked(bool)));
 c_=synapse::<span class="RenoLink"><a href="connect.html">connect</a></span>&lt;counterReached&gt;(this,&amp;QApplication::quit); //&lt;-- Was: connect(this, SIGNAL (counterReached()), QApplication::instance(), SLOT (quit()));
}
 
void Window::slotButtonClicked(bool checked)
{
 if (checked) {
 m_button-&gt;setText("Checked");
 } else {
 m_button-&gt;setText("Hello World");
 }
 
 m_counter ++;
 if (m_counter == 10) {
 synapse::<span class="RenoLink"><a href="emit.html">emit</a></span>&lt;counterReached&gt;(this); //&lt;-- Was: emit counterReached();
 }
}

int main(int argc, char **argv)
{
 QApplication app (argc, argv);
 
 Window window;
 window.show();
 
 return app.exec();
}</pre>
</div><div class="RenoAutoDIV"><div class="RenoHR"><hr/></div>
See also: <span class="RenoPageList"><a href="Tutorial.html">Tutorial</a></span>
</div>
<!-- Copyright (c) 2008-2013 Emil Dotchevski and Reverge Studios, Inc. -->
<!-- Distributed under the Boost Software License, Version 1.0. (See accompanying -->
<!-- file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt) -->
<div id="footer">
<p>
<a class="logo" href="http://jigsaw.w3.org/css-validator/check/referer"><img class="logo_pic" src="valid-css.png" alt="Valid CSS" height="31" width="88"/></a>
<a class="logo" href="http://validator.w3.org/check?uri=referer"><img class="logo_pic" src="valid-xhtml.png" alt="Valid XHTML 1.0" height="31" width="88"/></a>
<small>Copyright (c) 2015 by Emil Dotchevski and Reverge Studios, Inc.<br/>
Distributed under the <a href="http://www.boost.org/LICENSE_1_0.txt">Boost Software License, Version 1.0</a>.</small>
</p>
</div>
</div>
</div>
</div>
</body>
</html>
